import hashlib
import os
import time

class PasswordHasher:
    def __init__(self):
        self.users = []

    def _hash_password(self, password, salt=None):
        if salt is None:
            salt = os.urandom(16)
        password_hash = hashlib.scrypt(password.encode(), salt=salt, n=16384, r=8, p=1, dklen=64).hex()
        return password_hash, salt

    def add_user(self, username, password):
        password_hash, salt = self._hash_password(password)
        self.users.append({
            "username": username,
            "password_hash": password_hash,
            "salt": salt,
            "created_at": time.time()
        })
        print(f"User {username} added successfully.")

    def authenticate_user(self, username, password):
        for user in self.users:
            if user["username"] == username:
                password_hash, _ = self._hash_password(password, user["salt"])
                if user["password_hash"] == password_hash:
                    print(f"Authentication successful for user {username}")
                    return True
        print("Authentication failed.")
        return False

    def change_password(self, username, old_password, new_password):
        for user in self.users:
            if user["username"] == username:
                old_hash, _ = self._hash_password(old_password, user["salt"])
                if user["password_hash"] == old_hash:
                    new_hash, new_salt = self._hash_password(new_password)
                    user["password_hash"] = new_hash
                    user["salt"] = new_salt
                    print(f"Password changed successfully for user {username}")
                    return True
        print("Password change failed.")
        return False

    def list_users(self):
        print("List of users:")
        for user in self.users:
            print(f"Username: {user['username']}, Created at: {time.ctime(user['created_at'])}")

def main():
    hasher = PasswordHasher()
    
    hasher.add_user("alice", "password123")
    hasher.add_user("bob", "qwerty456")
    
    hasher.authenticate_user("alice", "password123")
    hasher.authenticate_user("bob", "wrongpassword")
    
    hasher.change_password("alice", "password123", "newpassword789")
    hasher.authenticate_user("alice", "newpassword789")
    
    hasher.list_users()

if __name__ == "__main__":
    main()