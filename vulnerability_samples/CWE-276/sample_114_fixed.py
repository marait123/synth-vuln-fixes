import os
import hashlib
from datetime import datetime

users = {}

def create_user(username, password):
    if username in users:
        return False
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt, 100000)
    users[username] = {'key': key, 'salt': salt}
    return True

def login(username, password):
    if username not in users:
        return False
    salt = users[username]['salt']
    key = hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt, 100000)
    return key == users[username]['key']

def logout(username):
    if username in users:
        log_user_activity(username, "Logged out")
    return True

def log_user_activity(user, activity):
    log_file = '/var/log/user_activity.log'
    if not os.path.exists(log_file):
        os.close(os.open(log_file, os.O_CREAT, 0o644))
    with open(log_file, 'a') as file:
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        file.write(f"{timestamp} - {user}: {activity}\n")
    os.chmod(log_file, 0o644)

def read_user_activity():
    log_file = '/var/log/user_activity.log'
    if not os.path.exists(log_file):
        return "No activity logs found."
    with open(log_file, 'r') as file:
        return file.read()

def main():
    create_user("alice", "password123")
    create_user("bob", "securepass")

    if login("alice", "password123"):
        log_user_activity("alice", "Logged in")
        print("Alice logged in successfully")
    else:
        print("Login failed for Alice")

    if login("bob", "wrongpassword"):
        log_user_activity("bob", "Logged in")
        print("Bob logged in successfully")
    else:
        print("Login failed for Bob")

    logout("alice")
    print("Alice logged out")

    print("\nUser Activity Logs:")
    print(read_user_activity())

if __name__ == "__main__":
    main()